#!/bin/bash


# Colors
GREEN='\033[1;32m' # Green
RESET='\033[0m' # No Color




# Install if not already
if [[ $IP == 127.0.0.1 ]] || [[ ! -f .env ]]; then

	echo "Redirecting to installation..."
	bash install
	exit

fi




# Get data from .env file
source .env




# Open that IP slot
ifconfig lo0 alias $IP up
echo -e "'${IP}' is now available to build server ... ${GREEN}done${RESET}"




# Start the docker containers
echo "Starting the server..."
docker-compose up -d




# Pulling latest changes from git
(
	cd site/
	git pull
	echo -e "Git pull complete ... ${GREEN}done${RESET}"
)




# If Gulp file and package.json exist in theme folder
if [[ -f site/wp-content/themes/${SLUG}/gulpfile.js ]] && [[ -f site/wp-content/themes/${SLUG}/package.json ]]; then


	# RUN THE GULP
	echo "GULP is running..."
	docker-compose run --no-deps --rm gulp npm start


fi